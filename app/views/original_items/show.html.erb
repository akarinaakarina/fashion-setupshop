<% breadcrumb :show %>
<%= render "shared/header" %>
<div class="item-show">
  <div class="item-box">
    <h2 class="name">
      <%= @original_item.name %>
    </h2>
    <div class="item-img-content">
      <%= image_tag @original_item.image,class:"item-box-img" %>
      <% if @original_item.buy.present?%>
        <div class="sold-out">
          <span>Sold Out!!</span>
        </div>
      <% end %>
    </div>
    <div class="item-price-box">
      <span class="item-price">
        <%= @original_item.price%>円
      </span>
      <span class="item-postage">
        <%= @original_item.delivery_style.name %>
      </span>
    </div>

    <% if user_signed_in? && @original_item.buy.nil? %>
      <% if current_user.id == @original_item.user_id %>
        <%= link_to "商品の編集", edit_original_item_path, method: :get, class: "item-red-btn" %>
        <p class="or-text">or</p>
        <%= link_to "削除", original_item_path, method: :delete, class:"item-destroy" %>
      <% else %>
          <%= link_to "購入画面に進む", original_item_buys_path(@original_item.id), class:"item-brack-btn"%>
      <% end %>
    <% end%>

    <div class="item-explain-box">
      <span><%= @original_item.description %></span>
    </div>
    <table class="detail-table">
      <tbody>
        <tr>
          <th class="detail-item">取り扱いショップ</th>
            <td class="detail-value">
              <a href="/users/<%= @original_item.user.id %>">
                <%= @original_item.user.shop_name %>
              </a>
            </td>
        </tr>
        <tr>
          <th class="detail-item">商品形態</th>
          <td class="detail-value"><%= @original_item.state.name %></td>
        </tr>
        <tr>
          <th class="detail-item">カテゴリー1</th>
          <td class="detail-value"><%= @original_item.category1.name %></td>
        </tr>
        <tr>
          <th class="detail-item">カテゴリー2</th>
          <td class="detail-value"><%= @original_item.category2.name %></td>
        </tr>
        <tr>
          <th class="detail-item">商品の状態</th>
          <td class="detail-value"><%= @original_item.size.name %></td>
        </tr>
        <tr>
          <th class="detail-item">配送料の負担</th>
          <td class="detail-value"><%= @original_item.delivery_style.name %></td>
        </tr>
        <tr>
          <th class="detail-item">発送元の地域</th>
          <td class="detail-value"><%= @original_item.prefecture.name %></td>
        </tr>
        <tr>
          <th class="detail-item">発送日の目安</th>
          <td class="detail-value"><%= @original_item.delivery_day.name %></td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <div class="comment-box">
    <% if user_signed_in? %>
      <%= form_with(model: [@original_item, @comment], local: true) do |f| %>
        <%= f.text_area :text, placeholder: "コメントする", rows: "2", class:"comment-text" %>
        <%= f.submit "コメントする", class: "comment-btn"%>
      <% end %>
    <% else %>
      <strong><p>※※※ コメントの投稿には新規登録/ログインが必要です ※※※</p></strong>
    <% end %>
    <div class="comments-title">
      <h4>コメントリスト</h4>
    </div>
      <% @comments.each do |comment| %>
        <div class="comment-list">
          <strong><%= link_to comment.user.nickname, "/users/#{comment.user_id}" %></strong>
          <div class="comment">
            <p><%= comment.text %></p>
          </div>
        </div>
      <% end %>
  <a href="#" class="another-item"><%= @original_item.category1.name %>をもっと見る</a>
</div>
